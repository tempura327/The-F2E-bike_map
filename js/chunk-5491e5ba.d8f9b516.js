(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5491e5ba"],{"7e9a":function(t,e,a){},8418:function(t,e,a){"use strict";var n=a("a04b"),i=a("9bf2"),s=a("5c6c");t.exports=function(t,e,a){var c=n(e);c in t?i.f(t,c,s(0,a)):t[c]=a}},"99af":function(t,e,a){"use strict";var n=a("23e7"),i=a("da84"),s=a("d039"),c=a("e8b5"),o=a("861d"),r=a("7b0b"),l=a("07fa"),d=a("8418"),u=a("65f0"),v=a("1dde"),h=a("b622"),f=a("2d00"),p=h("isConcatSpreadable"),b=9007199254740991,S="Maximum allowed index exceeded",m=i.TypeError,g=f>=51||!s((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),x=v("concat"),w=function(t){if(!o(t))return!1;var e=t[p];return void 0!==e?!!e:c(t)},y=!g||!x;n({target:"Array",proto:!0,forced:y},{concat:function(t){var e,a,n,i,s,c=r(this),o=u(c,0),v=0;for(e=-1,n=arguments.length;e<n;e++)if(s=-1===e?c:arguments[e],w(s)){if(i=l(s),v+i>b)throw m(S);for(a=0;a<i;a++,v++)a in s&&d(o,v,s[a])}else{if(v>=b)throw m(S);d(o,v++,s)}return o.length=v,o}})},a533:function(t,e,a){"use strict";a("7e9a")},c1c4:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.isSearched?a("div",{staticClass:"search-result"},[a("b-button",{staticClass:"d-flex p-1 mr-2",attrs:{variant:"link"},on:{click:function(e){t.isSearched=!t.isSearched,t.isStationSelected=!t.isStationSelected,t.selectedCity=""}}},[a("font-awesome-icon",{attrs:{icon:"angle-left"}})],1),a("ul",t._l(t.cityStationData,(function(e,n){return a("li",{key:n,staticClass:"a cursor-pointer mb-1",on:{click:function(a){return t.querySelectedStaion(e,e.StationUID)}}},[t._v(t._s(e.StationName.Zh_tw))])})),0)],1):a("div",{staticClass:"controller"},[a("h1",{staticClass:"h1 font-weight-3 mb-4"},[t._v("站牌搜尋")]),a("b-input",{staticClass:"mb-4"}),a("b-select",{staticClass:"mb-4",attrs:{options:t.cityOption},model:{value:t.selectedCity,callback:function(e){t.selectedCity=e},expression:"selectedCity"}}),a("b-button",{staticClass:"bg-primary",attrs:{block:""},on:{click:t.queryStation}},[t._v("搜尋")])],1),t.isStationSelected?a("div",{staticClass:"route-detail"},[a("h5",{staticClass:"h5 font-weight-3 mb-3"},[t._v(t._s(t.selectedStationData.StationName.Zh_tw))]),a("h6",{staticClass:"h6 mb-2"},[t._v(t._s(t.selectedStationData.StationAddress.Zh_tw))]),a("h6",{staticClass:"h6 mb-2"},[t._v("更新時間："+t._s(t.selectedStationData.SrcUpdateTime))]),a("div",{staticClass:"d-flex justify-content-between"},[a("div",{staticClass:"badge",class:t.selectedStationData.AvailableRentBikes>5?"bg-primary":t.selectedStationData.AvailableRentBikes<1?"bg-danger":"bg-success"},[a("span",{staticClass:"h6 font-weight-3 mr-2"},[t._v("可借車輛")]),a("span",[t._v(t._s(t.selectedStationData.AvailableRentBikes))])]),a("div",{staticClass:"badge",class:t.selectedStationData.AvailableReturnBikes>5?"bg-primary":t.selectedStationData.AvailableRentBikes<1?"bg-danger":"bg-success"},[a("span",{staticClass:"h6 font-weight-3 mr-2"},[t._v("可停空位")]),a("span",[t._v(t._s(t.selectedStationData.AvailableReturnBikes))])])])]):t._e(),a("div",[a("b-spinner",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]}),a("div",{attrs:{id:"map1"}})],1)])},i=[],s=a("1da1"),c=(a("96cf"),a("d81d"),a("d3b7"),a("99af"),a("fb6a"),a("ac1f"),a("5319"),a("e192")),o=a.n(c),r=a("6c2d"),l={name:"RentBike",components:{},data:function(){return{isLoading:!0,isSearched:!1,isStationSelected:!1,cityOption:[{text:"台北",value:"Taipei"},{text:"新北",value:"NewTaipei"},{text:"基隆",value:"Keelung"},{text:"桃園",value:"Taoyuan"},{text:"新竹",value:"Hsinchu"},{text:"苗栗",value:"Miaoli"},{text:"台中",value:"Taichung"},{text:"彰化",value:"Changhua"},{text:"南投",value:"Nantou"},{text:"雲林",value:"Yunlin"},{text:"嘉義",value:"Chiayi"},{text:"台南",value:"Tainan"},{text:"高雄",value:"Kaohsiung"},{text:"屏東",value:"Pingtung"},{text:"宜蘭",value:"Yilan"},{text:"花蓮",value:"Hualien"},{text:"台東",value:"Taitung"}],cityStationData:[],nearStationData:[],nearAvaliableStationData:[],selectedStationData:[],selectedCity:""}},mounted:function(){o.a.accessToken="pk.eyJ1IjoidGVtcHVyYTMyNyIsImEiOiJja3Z6eXVqdnQ1YTdxMm9tdHUwMGx4eXBmIn0.7SOTd4xVrpfdvJiDx5R34g",this.map=new o.a.Map({container:"map1",style:"mapbox://styles/mapbox/streets-v11",center:[121.5,25.1],zoom:10}),this.isLoading=!1},methods:{queryStation:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,n,i,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=(new Date).toGMTString(),n=new r["a"]("SHA-1","TEXT"),n.setHMACKey("OPt8cbnBt_P461mggB8qbzrZiDc","TEXT"),n.update("x-date: "+a),i=n.getHMAC("B64"),s='hmac username="83592d8c997f4933ae965e60e5995a2d", algorithm="hmac-sha1", headers="x-date", signature="'.concat(i,'"'),e.prev=6,e.next=9,fetch("https://ptx.transportdata.tw/MOTC/v2/Bike/Station/".concat(t.selectedCity,"?$top=30&$format=JSON"),{method:"GET",header:{Authorization:s,"X-Date":a,"Content-Type":"application/x-www-form-urlencoded"},"Accept-Encoding":"gzip"});case 9:c=e.sent,c.json().then((function(e){return t.cityStationData=e})),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),console.log("fail1");case 16:return e.prev=16,t.isSearched=!0,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[6,13,16,19]])})))()},querySelectedStaion:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,s,c,l,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=(new Date).toGMTString(),s=new r["a"]("SHA-1","TEXT"),s.setHMACKey("OPt8cbnBt_P461mggB8qbzrZiDc","TEXT"),s.update("x-date: "+i),c=s.getHMAC("B64"),l='hmac username="83592d8c997f4933ae965e60e5995a2d", algorithm="hmac-sha1", headers="x-date", signature="'.concat(c,'"'),n.prev=6,n.next=9,fetch("https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/".concat(a.selectedCity,"?$filter=StationUID%20eq%20'").concat(e,"'&$format=JSON"),{method:"GET",header:{Authorization:l,"X-Date":i,"Content-Type":"application/x-www-form-urlencoded"},"Accept-Encoding":"gzip"});case 9:d=n.sent,d.json().then((function(e){a.selectedStationData=t,a.selectedStationData.AvailableRentBikes=e[0].AvailableRentBikes,a.selectedStationData.AvailableReturnBikes=e[0].AvailableReturnBikes,a.selectedStationData.SrcUpdateTime=e[0].SrcUpdateTime.replace(/[A-Z]/," ").slice(0,19)})).then((function(){(new o.a.Marker).setLngLat([a.selectedStationData.StationPosition.PositionLon,a.selectedStationData.StationPosition.PositionLat]).addTo(a.map)})).then((function(){return a.isStationSelected=!0})),n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](6),a.$bvToast.toast("",{title:"失敗",autoHideDelay:3e3,variant:"danger"}),console.log("fail");case 17:case"end":return n.stop()}}),n,null,[[6,13]])})))()}},computed:{dynamicSize:function(){return[this.iconSize,1.15*this.iconSize]},dynamicAnchor:function(){return[this.iconSize/2,1.15*this.iconSize]}}},d=l,u=(a("a533"),a("2877")),v=Object(u["a"])(d,n,i,!1,null,null,null);e["default"]=v.exports},fb6a:function(t,e,a){"use strict";var n=a("23e7"),i=a("da84"),s=a("e8b5"),c=a("68ee"),o=a("861d"),r=a("23cb"),l=a("07fa"),d=a("fc6a"),u=a("8418"),v=a("b622"),h=a("1dde"),f=a("f36a"),p=h("slice"),b=v("species"),S=i.Array,m=Math.max;n({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var a,n,i,v=d(this),h=l(v),p=r(t,h),g=r(void 0===e?h:e,h);if(s(v)&&(a=v.constructor,c(a)&&(a===S||s(a.prototype))?a=void 0:o(a)&&(a=a[b],null===a&&(a=void 0)),a===S||void 0===a))return f(v,p,g);for(n=new(void 0===a?S:a)(m(g-p,0)),i=0;p<g;p++,i++)p in v&&u(n,i,v[p]);return n.length=i,n}})}}]);
//# sourceMappingURL=chunk-5491e5ba.d8f9b516.js.map